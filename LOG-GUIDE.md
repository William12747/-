# 轉換測試日誌指南

## 如何使用轉換測試面板

### 步驟 1: 打開測試面板
1. 啟動應用程式
2. 在應用程式頂部點擊「顯示轉換測試」按鈕
3. 轉換測試面板會出現在頁面上

### 步驟 2: 輸入測試路徑
1. **輸入文件路徑**: 輸入要測試轉換的影片文件完整路徑
   - 例如: `C:\Users\Rosh\Videos\test.avi`
   - 或: `D:\影片\舊檔\video.flv`

2. **輸出文件路徑**: 輸入轉換後的輸出文件完整路徑
   - 例如: `C:\Users\Rosh\Videos\test_output.mp4`
   - 注意: 不需要手動創建目錄，程式會自動創建

### 步驟 3: 開始測試
1. 點擊「開始測試轉換」按鈕
2. 觀察日誌輸出區域
3. 等待測試完成

### 步驟 4: 查看日誌
測試過程中，日誌會實時顯示：
- ✅ 綠色: 成功訊息
- ❌ 紅色: 錯誤訊息
- ℹ️ 藍色: 一般資訊

### 步驟 5: 匯出日誌
1. 測試完成後，點擊「匯出日誌」按鈕
2. 會下載一個文字檔，包含所有日誌
3. 可以將此文件提供給開發者進行診斷

## 日誌檢查點說明

### 前端檢查點
- **檢查點 1**: 檢查 window.electronAPI 是否可用
- **檢查點 2**: 調用 convertVideo API 並等待結果

### IPC 通信檢查點（在主進程控制台）
- **檢查點 1**: 接收參數
- **檢查點 2**: 檢查輸入文件是否存在
- **檢查點 3**: 檢查文件是否可讀
- **檢查點 4**: 調用 convertVideo 函數

### FFmpeg 處理檢查點（在主進程控制台）
- **檢查點 1**: 參數驗證
- **檢查點 2**: 檢查輸入文件
- **檢查點 3**: 確保輸出目錄存在
- **檢查點 4**: 使用 ffprobe 獲取影片資訊
- **檢查點 5**: 啟動 FFmpeg 轉換
- **檢查點 6**: 轉換完成/錯誤

## 如何查看主進程日誌

主進程的日誌會顯示在：
1. **終端機/命令提示字元視窗**（啟動應用程式的那個視窗）
2. 查找以 `[IPC]` 和 `[FFmpeg]` 開頭的日誌

## 常見問題診斷

### 問題 1: 卡在「檢查點 2: 調用 convertVideo API...」
**可能原因:**
- IPC 通信失敗
- 主進程沒有響應

**解決方法:**
- 查看主進程控制台是否有 `[IPC] ========== convert-video 處理開始 ==========` 日誌
- 如果沒有，表示 IPC 通信有問題

### 問題 2: 卡在「檢查點 4: 使用 ffprobe 獲取影片資訊...」
**可能原因:**
- 文件格式不支援
- 文件損壞
- FFmpeg 無法讀取文件

**解決方法:**
- 查看主進程控制台的錯誤訊息
- 確認文件格式是否在支援列表中（FLV, ASF, RMVB, MPEG, MPG, WMV, AVI）

### 問題 3: 卡在「檢查點 5: 啟動 FFmpeg 轉換...」
**可能原因:**
- FFmpeg 進程啟動失敗
- 編碼器問題

**解決方法:**
- 查看主進程控制台的 `[FFmpeg] stderr` 輸出
- 檢查是否有錯誤訊息

### 問題 4: 轉換過程中沒有進度更新
**可能原因:**
- 進度回調沒有被觸發
- FFmpeg 進程卡住

**解決方法:**
- 查看主進程控制台是否有 `[FFmpeg] 進度更新` 日誌
- 如果沒有，可能是 FFmpeg 進程問題

## 提供日誌給開發者

當遇到問題時，請提供：

1. **前端日誌**: 
   - 從轉換測試面板匯出的日誌文件
   - 或複製日誌輸出區域的所有內容

2. **主進程日誌**:
   - 從終端機/命令提示字元視窗複製所有 `[IPC]` 和 `[FFmpeg]` 開頭的日誌
   - 或截圖終端機視窗

3. **測試資訊**:
   - 輸入文件路徑
   - 輸出文件路徑
   - 文件大小
   - 文件格式

這樣開發者就能快速定位問題所在！
